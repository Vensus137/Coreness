name: "scenarios_manager"
description: "Менеджер сценариев и триггеров"
singleton: true
dependencies:
  utilities:
    - "logger"
settings:
  config_dir:
    type: string
    default: "config"
    description: "Папка с глобальными конфигурационными файлами"
  max_actions_limit:
    type: integer
    default: 50
    description: "Максимальное количество действий в развернутом сценарии"
  max_nesting_depth:
    type: integer
    default: 10
    description: "Максимальная глубина вложенности сценариев"
interface:
  methods:
    get_scenario:
      description: "Получить оригинальный сценарий по полному или короткому ключу"
      input:
        key:
          type: string
          description: "Полный ключ сценария (например, 'menu.one_attachment') или короткое имя ('one_attachment')"
      output:
        type: dict | null
        description: "Оригинальный сценарий или None"
    get_all_scenarios:
      description: "Получить все оригинальные сценарии"
      input: {}
      output:
        type: dict
        description: "Все сценарии с полными ключами"
    get_triggers:
      description: "Получить триггеры из config/triggers.yaml"
      input: {}
      output:
        type: dict
        description: "Триггеры"
    get_group_triggers:
      description: "Получить групповые триггеры из config/group_triggers.yaml и system/group_triggers.yaml (с приоритетом системных)"
      input: {}
      output:
        type: dict
        description: "Групповые триггеры (для публичных чатов)"
    get_scenario_key:
      description: "Получить полное имя сценария (file.scenario) по короткому или полному имени"
      input:
        name_or_key:
          type: string
          description: "Короткое или полное имя сценария"
      output:
        type: string | null
        description: "Полное имя сценария или None"
    get_scenario_name:
      description: "Получить короткое имя сценария по короткому или полному имени"
      input:
        name_or_key:
          type: string
          description: "Короткое или полное имя сценария"
      output:
        type: string | null
        description: "Короткое имя сценария или None"
    reload:
      description: "Перезагрузить все сценарии и триггеры"
      input: {}
      output:
        type: void
        description: "Нет возвращаемого значения"
features:
  - "Загрузка сценариев из config/scenarios/*.yaml"
  - "Контроль лимита действий и глубины вложенности"
  - "Кеширование оригинальных сценариев"
  - "Поиск сценариев по полному ключу (файл.сценарий) и короткому имени"
  - "Предупреждение при дублировании названий сценариев"
  - "Загрузка и объединение триггеров (triggers.yaml, group_triggers.yaml)"
  - "Поддержка системных триггеров с приоритетом" 