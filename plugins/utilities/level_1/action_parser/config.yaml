name: "action_parser"
description: "Универсальный парсер действия из базы данных"

dependencies:
  utilities:
    - "logger"

interface:
  methods:
    parse_action:
      description: "Объединяет prev_data, action_data и основные поля в один плоский dict, обрабатывает временные атрибуты"
      input:
        action:
          type: dict
          description: "Действие из базы данных с полями action_data (содержит prev_data), chat_id, message_id и др."
      output:
        type: dict
        description: "Плоский dict с объединенными данными и обработанными временными атрибутами"
features:
  - "Разворачивание prev_data из action_data с перезаписью"
  - "Объединение action_data с основными полями действия"
  - "Приоритет action_data над основными полями при конфликтах"
  - "Удаление служебных полей (action_data, prev_data) из результата"
  - "Обработка временных атрибутов (expire, unexpired, duration) → _seconds версии"
  - "Парсинг временных строк (5d 4h 30m 15s) в секунды"
  - "Используется всеми сервисами для получения 'плоского' action" 