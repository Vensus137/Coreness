# Master-bot ‚Äî –†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–≠—Ç–æ **–º–∞—Å—Ç–µ—Ä-–±–æ—Ç** ‚Äî –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Coreness, –ø–æ —Å–≤–æ–µ–π —Å—É—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —Ç–µ–Ω–∞–Ω—Ç–æ–≤.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**Master-bot** —Å–ª—É–∂–∏—Ç:
- **–†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–°–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ç–µ–Ω–∞–Ω—Ç–∞
- **–ñ–∏–≤—ã–º –ø—Ä–∏–º–µ—Ä–æ–º** ‚Äî –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
master-bot/
‚îú‚îÄ‚îÄ tg_bot.yaml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞ (–∫–æ–º–∞–Ω–¥—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îÇ
‚îú‚îÄ‚îÄ scenarios/               # –°—Ü–µ–Ω–∞—Ä–∏–∏ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ main/               # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands.yaml   # /start, /help, /menu
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ access.yaml     # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ errors.yaml     # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ default.yaml    # –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ management/         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–Ω–∞–Ω—Ç–æ–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tenant.yaml           # –ú–µ–Ω—é —Ç–µ–Ω–∞–Ω—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tenant_config.yaml    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tenant_storage.yaml   # –†–∞–±–æ—Ç–∞ —Å–æ Storage
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_storage.yaml     # User Storage
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ other/              # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loading.yaml    # –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mailing.yaml    # –†–∞—Å—Å—ã–ª–∫–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ scheduled/          # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
‚îÇ       ‚îî‚îÄ‚îÄ cleanup_temp_storage.yaml  # –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îî‚îÄ‚îÄ storage/                # Storage –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    ‚îú‚îÄ‚îÄ main.yaml           # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    ‚îî‚îÄ‚îÄ loading_animations.yaml  # –ê–Ω–∏–º–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
```

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
–ù–∞–≤–∏–≥–∞—Ü–∏—è —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏ —Å –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ –º–µ–∂–¥—É —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏:
```yaml
menu:
  trigger:
    - event_type: "message"
      event_text: "/menu"
  
  step:
    - action: "send_message"
      params:
        text: "üìã –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"
        inline:
          - [{"üè† –¢–µ–Ω–∞–Ω—Ç": "tenant"}, {"‚ÑπÔ∏è –ü–æ–º–æ—â—å": "help"}]
```

### 2. –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ `validate` action:
```yaml
access_check:
  step:
    - action: "validate"
      params:
        condition: "$user_role == 'admin'"
      transition:
        - action_result: "error"
          transition_action: "jump_to_scenario"
          transition_value: "access_denied"
```

### 3. –†–∞–±–æ—Ç–∞ —Å–æ Storage
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:
```yaml
# storage/main.yaml
settings:
  bot_name:
    value: "Master Bot"
    type: "string"
```

–î–æ—Å—Ç—É–ø –≤ —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö —á–µ—Ä–µ–∑ placeholders:
```yaml
text: "–ë–æ—Ç: {_storage.settings.bot_name}"
```

### 4. Scheduled –∑–∞–¥–∞—á–∏
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:
```yaml
cleanup_temp_storage:
  schedule: "0 3 * * *"  # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00
  
  step:
    - action: "update_storage"
      params:
        storage_type: "tenant"
        operation: "delete"
        key: "temp.*"
```

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å fallback:
```yaml
# errors.yaml
handle_error:
  step:
    - action: "send_message"
      params:
        text: "‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞

```yaml
help:
  trigger:
    - event_type: "message"
      event_text: "/help"
  
  step:
    - action: "send_message"
      params:
        text: |
          ‚ÑπÔ∏è <b>–°–ø—Ä–∞–≤–∫–∞</b>
          
          –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
          /menu - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
          /help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–µ–Ω—é —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

```yaml
tenant_menu:
  trigger:
    - event_type: "callback"
      callback_data: "tenant"
  
  step:
    - action: "send_message"
      params:
        text: "üè† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–Ω–∞–Ω—Ç–æ–º"
        inline:
          - [{"‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏": "tenant_config"}]
          - [{"üíæ Storage": "tenant_storage"}]
          - [{"üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏": "user_storage"}]
          - [{"üîô –ù–∞–∑–∞–¥": "start"}]
        message_edit: true
```

### –ü—Ä–∏–º–µ—Ä 3: –†–∞–±–æ—Ç–∞ —Å Storage

```yaml
show_settings:
  step:
    - action: "send_message"
      params:
        text: |
          ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–Ω–∞–Ω—Ç–∞
          
          –ù–∞–∑–≤–∞–Ω–∏–µ: {_storage.settings.bot_name}
          –í–µ—Ä—Å–∏—è: {_storage.settings.version}
```

## üîß –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### 1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `tg_bot.yaml` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –æ—Ç @BotFather:

```yaml
bot_token: "YOUR_BOT_TOKEN_HERE"
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã

–°–æ–∑–¥–∞–π—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –≤ `scenarios/main/commands.yaml`:

```yaml
my_command:
  trigger:
    - event_type: "message"
      event_text: "/mycommand"
  
  step:
    - action: "send_message"
      params:
        text: "–ú–æ—è –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!"
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Storage –∞—Ç—Ä–∏–±—É—Ç–æ–≤

–î–æ–±–∞–≤—å—Ç–µ –≤ `storage/main.yaml`:

```yaml
settings:
  new_setting:
    value: "–∑–Ω–∞—á–µ–Ω–∏–µ"
    type: "string"
```
