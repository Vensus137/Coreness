# –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞
validator_main:
  actions:
    - type: user
      user_state: "validator_test"
      expire: 60s
    - type: send
      text: |
        ‚úÖ <b>–¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö</b>
        
        –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
        –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—è—Ç—å —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫.
      inline:
        - [{"üîç –ü–æ–¥–ø–∏—Å–∫–∞ (1 —á–∞—Ç)": "validator_is_member_single"}, {"üîç –ü–æ–¥–ø–∏—Å–∫–∞ (–Ω–µ—Å–∫.)": "validator_is_member_multi"}]
        - [{"üîô –ú–µ–Ω—é": "start_menu"}]

validator_check:
  actions:
    - type: user
      user_state: ""
    - type: request
      request_name: "validator_test"
      chain: true
    - type: validator
      rules:
        request_text:
          - rule: "length_min"
            value: 5
      chain: true
    - type: send
      text: "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã (min 5) –ø—Ä–æ–π–¥–µ–Ω–∞!"
      chain: completed
    - type: validator
      rules:
        request_text:
          - rule: "starts_with"
            value: "test"
      chain: true
    - type: send
      text: "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏ ('test') –ø—Ä–æ–π–¥–µ–Ω–∞!"
      chain: completed
    - type: validator
      rules:
        request_text:
          - rule: "regex"
            value: "^[A-Za-z0-9\\s]+$"
      chain: true
    - type: send
      text: "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ª–∞—Ç–∏–Ω–∏—Ü—É –∏ —Ü–∏—Ñ—Ä—ã (regex) –ø—Ä–æ–π–¥–µ–Ω–∞!"
      chain: completed
    - type: validator
      rules:
        request_text:
          - rule: "length_max"
            value: 100
      chain: true
    - type: send
      text: "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã (max 100) –ø—Ä–æ–π–¥–µ–Ω–∞!"
      chain: completed
    - type: validator
      rules:
        request_text:
          - rule: "contains"
            value: "–≤–∞–ª–∏–¥"
      chain: true
    - type: send
      text: "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ '–≤–∞–ª–∏–¥' –ø—Ä–æ–π–¥–µ–Ω–∞!"
      chain: completed 

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –æ–¥–Ω–æ–º —á–∞—Ç–µ/–∫–∞–Ω–∞–ª–µ
validator_is_member_single:
  actions:
    - type: validator
      rules:
        user_id:
          - rule: "is_member"
            chat: -1002749258418
            on_error: "drop"
      chain: true
    - type: scenario
      value: ["validator_result_completed", "validator_result_failed", "validator_result_drop"]

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Ç–∞—Ö/–∫–∞–Ω–∞–ª–∞—Ö
validator_is_member_multi:
  actions:
    - type: validator
      rules:
        user_id:
          - rule: "is_member"
            chat:
              - -1002749258418   # TODO: –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π chat_id –∏–ª–∏ "@channel_username"
              - -1002222222222   # TODO: –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π chat_id –∏–ª–∏ "@channel_username"
            mode: "any"
            on_error: "pass"
      chain: true
    - type: scenario
      value: ["validator_result_completed", "validator_result_failed", "validator_result_drop"]

validator_result_failed:
  actions:
    - type: send
      text: "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º —á–∞—Ç–µ/–∫–∞–Ω–∞–ª–µ"
      callback_edit: false
      chain: failed
      chain_drop: completed

validator_result_drop:
  actions:
    - type: send
      text: "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–ª–µ–Ω—Å—Ç–≤–æ –≤ —á–∞—Ç–µ/–∫–∞–Ω–∞–ª–µ"
      callback_edit: false
      chain: drop
      chain_drop: completed

validator_result_completed:
  actions:
    - type: send
      text: "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Å—Ç–æ–∏—Ç –≤–æ –≤—Å–µ—Ö —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞—Ö/–∫–∞–Ω–∞–ª–∞—Ö"
      callback_edit: false
      chain: completed