# –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è STT
test_stt_main:
  actions:
    - type: user
      user_state: ""
    - type: send
      text: |
        üìã <b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</b>
        
        üîÑ <b>–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥</b> - –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
        ‚è≥ <b>–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥</b> - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤  
        üéØ <b>–û–±—â–∏–π —Ç–µ—Å—Ç</b> - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏ –æ–∂–∏–¥–∞–Ω–∏–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞
        
        <i>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∏–∂–µ:</i>
      inline:
        - [{"üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π STT": "sync_stt_test"}, {"‚è≥ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π STT": "async_stt_test"}]
        - [{"üéØ –û–±—â–∏–π —Ç–µ—Å—Ç": "general_stt_test"}]
        - [{"üîô –ú–µ–Ω—é": "start_menu"}]
      callback_edit: false

# –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç STT
sync_stt_test:
  actions:
    - type: send
      text: "üîÑ –¢–µ—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ STT"
      callback_edit: false
    - type: send
      text: |
        üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∞–π–ª: <code>speech/examples/–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞.mp3</code>
        ‚öôÔ∏è –ú–µ—Ç–æ–¥: –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API SaluteSpeech
        
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º...
      attachment: 
        - "speech/examples/–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞.mp3"
      callback_edit: false
      chain: true
    - type: from_speech
      audio_file: "speech/examples/–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞.mp3"
      voice: "Ost_24000"
      chain: completed
    - type: scenario
      value: "stt_result"

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç STT
async_stt_test:
  actions:
    - type: send
      text: "‚è≥ –¢–µ—Å—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ STT"
      callback_edit: false
    - type: send
      text: |
        üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∞–π–ª: <code>speech/examples/–ë–æ—Ä–∏—Å.mp3</code>
        ‚öôÔ∏è –ú–µ—Ç–æ–¥: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API SaluteSpeech
        
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º...
      attachment: 
        - "speech/examples/–ë–æ—Ä–∏—Å.mp3"
      callback_edit: false
      chain: true
    - type: from_speech
      audio_file: "speech/examples/–ë–æ—Ä–∏—Å.mp3"
      voice: "Bys_24000"
      chain: completed
    - type: scenario
      value: "stt_result"

# –û–±—â–∏–π —Ç–µ—Å—Ç STT —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞
general_stt_test:
  actions:
    - type: user
      user_state: "waiting_audio_upload"
      chain: true
    - type: send
      text: |
        üì§ <b>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è STT</b>
        
        üìã –°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞
        üéµ –î–µ–π—Å—Ç–≤–∏–µ: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ª—é–±–æ–π –∞—É–¥–∏–æ—Ñ–∞–π–ª (.mp3, .ogg, .wav)
        
        –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω —á–µ—Ä–µ–∑ STT
      inline:
        - [{"üîô –ù–∞–∑–∞–¥": "test_stt_main"}]
      callback_edit: false
      chain: completed

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞
handle_audio_upload:
  actions:
    - type: request
      request_name: "stt_test"
    - type: scenario
      value: stt_validation
    - type: from_speech
      chain: completed
    - type: scenario
      value: "stt_result"

# –†–µ–∑—É–ª—å—Ç–∞—Ç STT
stt_result:
  actions:
    - type: send
      text: |
        ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—á—å
      chain: failed
      chain_drop: completed
    - type: send
      text: "‚úÖ STT –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!"
      callback_edit: false
      chain: true
    - type: send
      text: "{speech_to_text}"
      inline:
        - [{"üîô –ù–∞–∑–∞–¥": "test_stt_main"}]
      placeholder: true
      callback_edit: false
      chain: true

stt_validation:
  actions:
    - type: validator
      rules:
        attachments:
          - rule: "not_empty"
      chain: true
    - type: send
      text: |
        ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—É–¥–∏–æ—Ñ–∞–π–ª
      message_reply: true
      chain: failed
      chain_drop: completed
    - type: send
      text: |
        üéµ –§–∞–π–ª –ø–æ–ª—É—á–µ–Ω!

        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ STT...
      callback_edit: false
      chain: true

stt_from_command:
  actions:
    - type: validator
      attachments: "{reply_attachments}"
      placeholder: true
      chain: true
    - type: scenario
      value: stt_validation
    - type: from_speech
      chain: completed
    - type: scenario
      value: "stt_result"